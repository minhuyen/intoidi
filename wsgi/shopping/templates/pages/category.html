{% extends "pages/page.html" %}

{% load mezzanine_tags shop_tags i18n %}
{#{% block body_id %}category{% endblock %}#}
{##}
{#{% block all_content %}{{ block.super }}#}
{##}
{#{% editable page.category.content %}#}
{#{{ page.category.content|safe }}#}
{#{% endeditable %}#}
{##}
{#{% if child_categories %}#}
{#<div class="row shop-category-list">#}
{#{% if settings.SHOP_CATEGORY_USE_FEATURED_IMAGE %}#}
{#    {% for category in child_categories %}#}
{#    <div class="col-xs-6 col-sm-4 col-lg-3">#}
{#    <a href="{{ category.get_absolute_url }}" class="thumbnail">#}
{#        {% if category.featured_image %}#}
{#        <img src="{{ MEDIA_URL }}{% thumbnail category.featured_image 148 148 %}" />#}
{#        {% else %}#}
{#        <div class="placeholder"></div>#}
{#        {% endif %}#}
{#        <div class="caption">#}
{#            <h4>{{ category.title }}</h4>#}
{#        </div>#}
{#    </a>#}
{#    </div>#}
{#    {% endfor %}#}
{#{% else %}#}
{#    {% for category in child_categories %}#}
{#    <div class="col-xs-6 col-sm-4 col-lg-3">#}
{#    <a href="{{ category.get_absolute_url }}" class="thumbnail">#}
{#        <div class="caption"><h4>{{ category.title }}</h4></div>#}
{#    </a>#}
{#    </div>#}
{#    {% endfor %}#}
{#{% endif %}#}
{#</div>#}
{#{% endif %}#}
{##}
{#{% if products.paginator.count != 0 %}#}
{##}
{#<form class="product-sorting" role="form">#}
{#    <div class="form-group">#}
{#    <label class="control-label" for="sorting-select">{% trans "Sort by" %}</label>#}
{#        <select onchange="location.href = this[this.selectedIndex].value;" class="form-control" id="sorting-select">#}
{#        {% for name, option in settings.SHOP_PRODUCT_SORT_OPTIONS %}#}
{#        {% if "rating" not in option or settings.SHOP_USE_RATINGS %}#}
{#        <option{% if option == products.sort_by %} selected{% endif %}#}
{#            value="{{ category.get_absolute_url }}?sort={{ option }}{{ querystring }}">#}
{#            {{ name }}#}
{#        </option>#}
{#        {% endif %}#}
{#        {% endfor %}#}
{#        </select>#}
{#    </div>#}
{#</form>#}
{##}
{#<div class="row product-list">#}
{#{% for product in products.object_list %}#}
{#    <div class="col-xs-6 col-sm-4 col-lg-3 product-thumb">#}
{#    <a href="{{ product.get_absolute_url }}" class="thumbnail">#}
{#        {% if product.image %}#}
{#        <img src="{{ MEDIA_URL }}{% thumbnail product.image 148 148 %}">#}
{#        {% else %}#}
{#        <div class="placeholder"></div>#}
{#        {% endif %}#}
{#        <div class="caption">#}
{#        <h6>{{ product }}</h6>#}
{#        <div class="price-info">#}
{#        {% if product.has_price %}#}
{#            {% if product.on_sale %}#}
{#            <span class="old-price">{{ product.unit_price|currency }}</span>#}
{#            {% trans "On sale:" %}#}
{#            {% endif %}#}
{#            <span class="price">{{ product.price|currency }}</span>#}
{#        {% else %}#}
{#            <span class="coming-soon">{% trans "Coming soon" %}</span>#}
{#        {% endif %}#}
{#        </div>#}
{#        </div>#}
{#    </a>#}
{#    </div>#}
{#{% endfor %}#}
{#</div>#}
{##}
{#{% pagination_for products %}#}
{##}
{#{% endif %}#}
{##}
{#{% endblock %}#}



{% load mezzanine_tags keyword_tags staticfiles pages_tags shopping_filters %}
{% block all_content %}
<!-- Content -->
  	<div class="content">
		<div class="product">
			<div class="product-menu">
				<h4>Thể Loại 2</h4>
                {% if categories %}
                    {% for category in child_categories %}
                        {% if forloop.first %}
                            <ul>
                        {% endif %}
                                <li><a href="#">{{ category.name }}</a></li>
                        {% if forloop.last %}
                            </ul>
                        {% endif %}
                    {% endfor %}
                {% endif %}
				<h4>Thể Loại 2</h4>
                {% if categories %}
                    {% for category in child_categories %}
                        {% if forloop.first %}
                            <ul>
                        {% endif %}
                                <li><a href="#">{{ category.name }}</a></li>
                        {% if forloop.last %}
                            </ul>
                        {% endif %}
                    {% endfor %}
                {% endif %}
				<h4>Thiết Kế Của Thành Viên</h4>
				<ul>
					<li><a href="#">Yêu thích nhất</a></li>
					<li><a href="#">Hình thiết kế</a></li>
				</ul>
				<h4 class="tit-color">Màu sắc</h4>
                <div class="list-color">
                    {% if color_list %}
                        {% for color in color_list %}
                            <a href="#" style="background: {{ color.name }}"></a>
                        {% endfor %}
                    {% endif %}
                </div>
			</div>
			<div class="product-content">
				<h4>MỚI NHẤT / YÊU THÍCH nhất</h4>
				<div class="product-list">
                    {% if products %}
                        {% for product in products %}
                            <div class="product-items">
                                <div class="sale-info">
                                    <span class="new">New</span>
                                    {% if product.on_sale %}
                                        <span class="sale">Sale</span>
                                    {% endif %}
                                </div>
                                <a href="{{ product.get_absolute_url }}">
                                    {% if product.image %}
                                        <img u="image" src="{{ MEDIA_URL }}{% thumbnail product.image 148 148 %}"  />
                                    {% else %}
                                        <div class="placeholder"></div>
                                    {% endif %}

                                </a>
                                <div class="product-info">
                                    <p class="name-product">{{ product.title }}</p>
                                    <p>Đăng bởi: </p> <span class="user-post">{{ product.user }}</span>
                                    {% if product.unit_price != product.sale_price %}
                                        <p>Giá: </p> <span class="price">{{ product.sale_price }}₫</span> <span class="price-old">{{ product.unit_price }}₫</span>
                                    {% else %}
                                        <p>Giá: </p> <span class="price">{{ product.unit_price }}₫</span>
                                    {% endif %}
                                {% with isLiked="is_liked"|add_str:product.id %}
{#                                        {{ request|get_cookies:isLiked }}#}
                                        {{ request|get_session:isLiked }}
                                        {% if user.is_authenticated %}
                                            <button id ="likes" data-productId="{{product.id}}" class="btn btn-mini btn-primary like-button" type="button">Like</button>
                                        {% endif %}
                                {% endwith %}
                                </div>
                            </div>
                        {% endfor %}
                    {% endif %}

					<div class="paging">
                        {% for i in products.paginator.num_pages|get_range %}
                            {% if products.number == i %}
                                <a href="javascript:void(0)" class="selected">{{ i }}</a>
                            {% else %}
                                <a href="?page={{ i }}">{{ i }}</a>
                            {% endif %}
                            {% if forloop.last %}
                            {% endif %}
                        {% endfor %}
                    </div>
				</div>
			</div>
		</div>
	</div>
	<!-- /. Content -->
    <script>
        $('.like-button').click(function(){
            var productId;
            productId = $(this).attr("data-productId");
            $.ajax({
                url: "{% url 'shopping:like_product' %}",
                type: "GET",
                data: {product_id: productId},
                success: function(data){
                    console.log(data);
                    $('#likes').hide();
                }
            })
        });

    </script>
{% endblock %}
